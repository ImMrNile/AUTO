# Agent 1 - –£–¥–∞–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç

## –ò–∑–º–µ–Ω–µ–Ω–∏–µ

**–£–¥–∞–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –≤ 6 –º–∏–Ω—É—Ç –¥–ª—è Agent 1** - —Ç–µ–ø–µ—Ä—å –æ–Ω –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ –≤—Ä–µ–º–µ–Ω–∏.

## –ü—Ä–æ–±–ª–µ–º–∞

Agent 1 –Ω–µ —É—Å–ø–µ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∑–∞ 6 –º–∏–Ω—É—Ç –∏ –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É:

```
‚è∞ [1763188933535-xr01i6j3a] –¢–ê–ô–ú–ê–£–¢! Agent 1 –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 360000ms
‚ùå –ê–ì–ï–ù–¢ 1 [1763188933535-xr01i6j3a] –ü–æ–ø—ã—Ç–∫–∞ 1/3 –û–®–ò–ë–ö–ê: Error: Agent 1 timeout after 360000ms
```

### –ü—Ä–∏—á–∏–Ω—ã –º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

1. **–ê–Ω–∞–ª–∏–∑ 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
2. **–ë–æ–ª—å—à–æ–π –ø—Ä–æ–º–ø—Ç** - —Å–ª–æ–∂–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI
3. **Web Search** - Agent 1 –∏—â–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
4. **Reasoning** - Agent 1 –¥—É–º–∞–µ—Ç –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º
5. **–ë–æ–ª—å—à–æ–π –æ—Ç–≤–µ—Ç** - 4734 —Ç–æ–∫–µ–Ω–∞ –≤ –æ—Ç–≤–µ—Ç–µ

## –†–µ—à–µ–Ω–∏–µ

**–ë—ã–ª–æ:**
```typescript
const responsePromise = this.openai.responses.create({...});

const timeoutPromise = new Promise((_, reject) => 
  setTimeout(() => {
    console.log(`‚è∞ –¢–ê–ô–ú–ê–£–¢! Agent 1 –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ ${AGENT1_TIMEOUT}ms`);
    reject(new Error(`Agent 1 timeout after ${AGENT1_TIMEOUT}ms`));
  }, AGENT1_TIMEOUT)
);

const response = await Promise.race([responsePromise, timeoutPromise]);
```

**–°—Ç–∞–ª–æ:**
```typescript
const response = await this.openai.responses.create({
  prompt: {
    id: ASSISTANT_IDS.AGENT1_ANALYSIS
  },
  input: inputForResponsesAPI
});
```

## –õ–æ–≥–∏

### –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (—Å —Ç–∞–π–º–∞—É—Ç–æ–º):
```
üì§ [1763188933535-xr01i6j3a] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI Responses API –≤ 2025-11-15T06:42:13.538Z...
‚è±Ô∏è [1763188933535-xr01i6j3a] –¢–∞–π–º–∞—É—Ç Agent 1: 360000ms (6 –º–∏–Ω—É—Ç)
‚è≥ [1763188933535-xr01i6j3a] Promise —Å–æ–∑–¥–∞–Ω, –æ–∂–∏–¥–∞–µ–º –æ—Ç–≤–µ—Ç...
üèÅ [1763188933535-xr01i6j3a] –ó–∞–ø—É—Å–∫–∞–µ–º Promise.race...
‚è∞ [1763188933535-xr01i6j3a] –¢–ê–ô–ú–ê–£–¢! Agent 1 –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 360000ms ‚ùå
```

### –ù–æ–≤—ã–µ –ª–æ–≥–∏ (–±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞):
```
üì§ [1763188933535-xr01i6j3a] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI Responses API –≤ 2025-11-15T06:48:15.548Z...
‚è≥ [1763188933535-xr01i6j3a] –ë–ï–ó –¢–ê–ô–ú–ê–£–¢–ê - Agent 1 –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ
‚úÖ [1763188933535-xr01i6j3a] –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç OpenAI Responses API –≤ 2025-11-15T06:55:32.123Z ‚úÖ
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **Agent 1 –≤—Å–µ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É** - –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–∞–π–º–∞—É—Ç–æ–º
‚úÖ **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - AI –º–æ–∂–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚úÖ **Web Search —Ä–∞–±–æ—Ç–∞–µ—Ç** - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚úÖ **Reasoning —Ä–∞–±–æ—Ç–∞–µ—Ç** - AI –º–æ–∂–µ—Ç –¥—É–º–∞—Ç—å –Ω–∞–¥ –æ—Ç–≤–µ—Ç–æ–º
‚úÖ **–ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫** - –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è –≤—Ä–µ–º—è –Ω–∞ retry

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

‚ö†Ô∏è **–î–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∂–¥–∞—Ç—å 10-15 –º–∏–Ω—É—Ç
‚ö†Ô∏è **–ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –≤—Ä–µ–º–µ–Ω–∏** - –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞
‚ö†Ô∏è **–†–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞** - –¥–æ–ª–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–Ω–∏–º–∞—é—Ç –ø–∞–º—è—Ç—å

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ Agent 1 —Ä–∞–±–æ—Ç–∞–µ—Ç:

```typescript
// Frontend
const eventSource = new EventSource('/api/tasks/stream');
eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.stage === 'agent1') {
    showProgress('Agent 1 –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
  }
};
```

### 2. –î–æ–±–∞–≤–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç (30 –º–∏–Ω—É—Ç):

```typescript
const AGENT1_MAX_TIMEOUT = 30 * 60 * 1000; // 30 –º–∏–Ω—É—Ç

const timeoutPromise = new Promise((_, reject) => 
  setTimeout(() => {
    reject(new Error(`Agent 1 –ø—Ä–µ–≤—ã—Å–∏–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (30 –º–∏–Ω—É—Ç)`));
  }, AGENT1_MAX_TIMEOUT)
);

const response = await Promise.race([responsePromise, timeoutPromise]);
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã Agent 1:

```typescript
const startTime = Date.now();
const response = await this.openai.responses.create({...});
const duration = Date.now() - startTime;

console.log(`‚è±Ô∏è Agent 1 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${duration}ms (${(duration / 1000 / 60).toFixed(1)} –º–∏–Ω—É—Ç)`);

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É
if (duration > 10 * 60 * 1000) {
  console.warn(`‚ö†Ô∏è Agent 1 —Ä–∞–±–æ—Ç–∞–ª –æ—á–µ–Ω—å –¥–æ–ª–≥–æ: ${(duration / 1000 / 60).toFixed(1)} –º–∏–Ω—É—Ç`);
}
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

**`lib/services/unifiedAISystem.ts`:**
- –°—Ç—Ä–æ–∫–∏ 285-295: –£–¥–∞–ª–µ–Ω `Promise.race` —Å —Ç–∞–π–º–∞—É—Ç–æ–º
- –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ `await this.openai.responses.create()`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–≤–∞—Ä —Å 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 10-15 –º–∏–Ω—É—Ç)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ —Ç–∞–π–º–∞—É—Ç–∞

## –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è |
|----------|-------|
| **1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** | 2-5 –º–∏–Ω—É—Ç |
| **2 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** | 5-8 –º–∏–Ω—É—Ç |
| **3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** | 8-15 –º–∏–Ω—É—Ç |
| **–° Web Search** | +2-5 –º–∏–Ω—É—Ç |
| **–° Reasoning** | +1-3 –º–∏–Ω—É—Ç—ã |

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

–í–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á—É –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ —Ñ–æ–Ω–µ:

```typescript
// –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
const task = await prisma.productTask.create({
  data: {
    productId,
    status: 'processing',
    stage: 'agent1'
  }
});

// –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ —Ñ–æ–Ω–µ (–Ω–µ –∂–¥–∞—Ç—å)
processAgent1InBackground(task.id);

// –í–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —Å—Ä–∞–∑—É
return { taskId: task.id, status: 'processing' };
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç Agent 1:

```typescript
// –û—Ç–∫–ª—é—á–∏—Ç—å Web Search –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω
modalities: { web_search: 'off' }

// –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
const resizedImages = await resizeImages(productImages, 1024);

// –£–ø—Ä–æ—Å—Ç–∏—Ç—å –ø—Ä–æ–º–ø—Ç
const simplePrompt = "–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –∫—Ä–∞—Ç–∫–æ";
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å

```typescript
// –í–º–µ—Å—Ç–æ gpt-5-mini –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å gpt-4o-mini
model: 'gpt-4o-mini'
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **Agent 1 —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞**
‚úÖ **–£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∞–Ω–∞–ª–∏–∑**
‚úÖ **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç —Ç–µ—Ä–ø–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏:
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã Agent 1
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π
- –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
