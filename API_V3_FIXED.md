# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: WB API v3 - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

## üîç –ß—Ç–æ –ø–æ–∫–∞–∑–∞–ª–∏ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∏ –í–æ—Ä–æ–Ω–∫–∞
```json
{
  "detail": "invalid: selectedPeriod (field required)"
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å `period`, –∞ –Ω—É–∂–Ω–æ `selectedPeriod`

---

### –û—à–∏–±–∫–∞ 2: –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```json
{
  "detail": "invalid: orderBy (field required)"
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É–∫–∞–∑–∞–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `orderBy`

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ ‚úÖ

**–ë—ã–ª–æ:**
```typescript
body: JSON.stringify({
  period: {  // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
    start: startDate,
    end: endDate
  },
  nmIds: [nmId]
})
```

**–°—Ç–∞–ª–æ:**
```typescript
body: JSON.stringify({
  selectedPeriod: {  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
    start: startDate,
    end: endDate
  },
  pastPeriod: {  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–∏–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    start: pastStartDate,
    end: pastEndDate
  },
  nmIds: [nmId],
  orderBy: {  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    field: 'openCard',
    mode: 'desc'
  }
})
```

**Endpoint:** `POST /api/analytics/v3/sales-funnel/products`

---

### 2. –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ ‚úÖ

**–ë—ã–ª–æ:**
```typescript
body: JSON.stringify({
  period: {  // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
    start: startDate,
    end: endDate
  },
  nmIds: [nmId]
})
```

**–°—Ç–∞–ª–æ:**
```typescript
body: JSON.stringify({
  selectedPeriod: {  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
    start: startDate,
    end: endDate
  },
  nmIds: [nmId]
})
```

**Endpoint:** `POST /api/analytics/v3/sales-funnel/products/history`

---

### 3. –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚úÖ

**–ë—ã–ª–æ:**
```typescript
body: JSON.stringify({
  currentPeriod: {
    start: startDate,
    end: endDate
  },
  nmIds: [nmId],
  topOrderBy: 'orders',
  limit: 30,
  includeSubstitutedSKUs: true,
  includeSearchTexts: true
  // ‚ùå –ù–µ—Ç orderBy
})
```

**–°—Ç–∞–ª–æ:**
```typescript
body: JSON.stringify({
  currentPeriod: {
    start: startDate,
    end: endDate
  },
  nmIds: [nmId],
  topOrderBy: 'orders',
  limit: 30,
  includeSubstitutedSKUs: true,
  includeSearchTexts: true,
  orderBy: {  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    field: 'avgPosition',
    mode: 'asc'
  }
})
```

**Endpoint:** `POST /api/v2/search-report/product/search-texts`

---

## üìã –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã WB API v3

### Sales Funnel Products (–∫–æ–Ω–≤–µ—Ä—Å–∏—è):
```typescript
{
  selectedPeriod: {  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
    start: "YYYY-MM-DD",
    end: "YYYY-MM-DD"
  },
  pastPeriod: {  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    start: "YYYY-MM-DD",
    end: "YYYY-MM-DD"
  },
  nmIds: [123456],  // –ú–∞—Å—Å–∏–≤ nmID
  orderBy: {  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
    field: "openCard" | "cartCount" | "orderCount",
    mode: "asc" | "desc"
  }
}
```

### Sales Funnel History (–≤–æ—Ä–æ–Ω–∫–∞):
```typescript
{
  selectedPeriod: {  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
    start: "YYYY-MM-DD",
    end: "YYYY-MM-DD"
  },
  nmIds: [123456]
}
```

### Search Report (–ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã):
```typescript
{
  currentPeriod: {
    start: "YYYY-MM-DD",
    end: "YYYY-MM-DD"
  },
  nmIds: [123456],
  topOrderBy: "orders" | "openCard" | "addToCart",
  orderBy: {  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
    field: "avgPosition" | "openCard" | "orders",
    mode: "asc" | "desc"
  },
  limit: 30,
  includeSubstitutedSKUs: true,
  includeSearchTexts: true
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä:
```bash
npm run dev
```

### –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:
```
http://localhost:3000/test-ai-optimization
```

### –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ üîç –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
‚úÖ üìä –ö–æ–Ω–≤–µ—Ä—Å–∏—è - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
‚úÖ üõí –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
```

---

## üìä –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ü–æ –∫–∞–∫–∏–º –∑–∞–ø—Ä–æ—Å–∞–º –Ω–∞—Ö–æ–¥—è—Ç —Ç–æ–≤–∞—Ä
- –ü–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ–∏—Å–∫–µ
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫–∞–∑–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤

### ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–∞—Ä—Ç–æ—á–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
- –ó–∞–∫–∞–∑—ã –∏ –≤—ã–∫—É–ø—ã
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –ø–µ—Ä–∏–æ–¥–æ–º

### ‚úÖ –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂
- –ò—Å—Ç–æ—Ä–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ –¥–Ω—è–º
- –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –¢—Ä–µ–Ω–¥—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## ‚ö†Ô∏è –†–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ - –æ—à–∏–±–∫–∞ 405

**–û—à–∏–±–∫–∞:**
```
üì¢ –ö–∞–º–ø–∞–Ω–∏–∏: ‚ùå
   –û—à–∏–±–∫–∞: WB API error: 405
```

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–∫–µ–Ω –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ Promotion API

**–†–µ—à–µ–Ω–∏–µ:** 
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ **Promotion**
2. –û–±–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∫–∞–±–∏–Ω–µ—Ç–µ

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∞–Ω—ã –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
- https://dev.wildberries.ru/en/openapi/analytics

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ API v3:
- `period` ‚Üí `selectedPeriod` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –î–æ–±–∞–≤–ª–µ–Ω `pastPeriod` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `orderBy` —Å—Ç–∞–ª –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç: `YYYY-MM-DD`

---

## ‚úÖ –ò—Ç–æ–≥

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- ‚úÖ –§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- ‚úÖ –§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤–æ—Ä–æ–Ω–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω orderBy –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–µ—Ä–∏–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Å orderBy)
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (—Å selectedPeriod + pastPeriod)
- ‚úÖ –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ (—Å selectedPeriod)

### –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞):
- ‚ùå –†–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ (–Ω—É–∂–µ–Ω Promotion API)
- ‚ùå –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–Ω—É–∂–µ–Ω Promotion API)

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
npm run dev
```

**3 –∏–∑ 5 API endpoints —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** üéâ

**–î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö 2 –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ Promotion.**
