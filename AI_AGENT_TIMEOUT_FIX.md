# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: Agent 2 Timeout –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –±–æ–ª—å—à–∏—Ö JSON

## –ü—Ä–æ–±–ª–µ–º–∞

Agent 2 –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É—Ö–æ–¥–∏–ª –≤ **timeout –ø–æ—Å–ª–µ 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)** –ø—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ JSON:

```
‚è≥ [Agent 2] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (110—Å)
‚ùå –ü–æ–ø—ã—Ç–∫–∞ 1 –Ω–µ —É–¥–∞–ª–∞—Å—å (Agent 2): Error: Agent 2 timeout after 120000ms
‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ 2000ms –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π Agent 2...
‚è≥ [Agent 2] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (232—Å)
‚ùå –ü–æ–ø—ã—Ç–∫–∞ 2 –Ω–µ —É–¥–∞–ª–∞—Å—å (Agent 2): Error: Agent 2 timeout after 120000ms
```

### –ü—Ä–∏—á–∏–Ω—ã

1. **Agent 1** —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç **318 —Å–µ–∫—É–Ω–¥ (5+ –º–∏–Ω—É—Ç)** - –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
2. **Agent 2** –ø–æ–ª—É—á–∞–µ—Ç –±–æ–ª—å—à–æ–π JSON –æ—Ç Agent 1 (2600+ —Å–∏–º–≤–æ–ª–æ–≤)
3. **–¢–∞–π–º–∞—É—Ç 120 —Å–µ–∫—É–Ω–¥** –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–æ–≥–æ JSON
4. Agent 2 –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –†–µ—à–µ–Ω–∏–µ

### –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –æ–±–æ–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–ë—ã–ª–æ:**
```typescript
export const QUALITY_REQUIREMENTS = {
  AGENT_TIMEOUT: 120000 // 2 –º–∏–Ω—É—Ç—ã - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
};
```

**–°—Ç–∞–ª–æ:**
```typescript
export const QUALITY_REQUIREMENTS = {
  AGENT1_TIMEOUT: 360000, // 6 –º–∏–Ω—É—Ç –¥–ª—è Agent 1 (–∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
  AGENT2_TIMEOUT: 300000  // 5 –º–∏–Ω—É—Ç –¥–ª—è Agent 2 (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON)
};
```

### –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è Agent 1

**–ë—ã–ª–æ (–±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞):**
```typescript
const response = await this.openai.responses.create({
  prompt: { id: ASSISTANT_IDS.AGENT1_ANALYSIS },
  input: inputForResponsesAPI
} as any);
```

**–°—Ç–∞–ª–æ (—Å —Ç–∞–π–º–∞—É—Ç–æ–º):**
```typescript
const responsePromise = this.openai.responses.create({
  prompt: { id: ASSISTANT_IDS.AGENT1_ANALYSIS },
  input: inputForResponsesAPI
} as any);

const timeoutPromise = new Promise((_, reject) => 
  setTimeout(() => reject(new Error(`Agent 1 timeout after ${QUALITY_REQUIREMENTS.AGENT1_TIMEOUT}ms`)), 
  QUALITY_REQUIREMENTS.AGENT1_TIMEOUT)
);

const response = await Promise.race([responsePromise, timeoutPromise]) as any;
```

### –û–±–Ω–æ–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è Agent 2

**–ë—ã–ª–æ:**
```typescript
setTimeout(() => reject(new Error(`Agent 2 timeout after ${QUALITY_REQUIREMENTS.AGENT_TIMEOUT}ms`)), 
  QUALITY_REQUIREMENTS.AGENT_TIMEOUT)
```

**–°—Ç–∞–ª–æ:**
```typescript
setTimeout(() => reject(new Error(`Agent 2 timeout after ${QUALITY_REQUIREMENTS.AGENT2_TIMEOUT}ms`)), 
  QUALITY_REQUIREMENTS.AGENT2_TIMEOUT)
```

## –ü–æ—á–µ–º—É —Ä–∞–∑–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã?

### Agent 1 (6 –º–∏–Ω—É—Ç)
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç **–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (–¥–æ 5 —à—Ç—É–∫)
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç **—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏** –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ**
- –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å **–∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π WB**
- –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–¥–æ–ª—å—à–µ –≤—Å–µ—Ö**

### Agent 2 (5 –º–∏–Ω—É—Ç)
- –ü–æ–ª—É—á–∞–µ—Ç **–≥–æ—Ç–æ–≤—ã–π JSON** –æ—Ç Agent 1
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤ **—Ñ–æ—Ä–º–∞—Ç WB API**
- –î–æ–±–∞–≤–ª—è–µ—Ç **ID —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç **–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å**
- –†–∞–±–æ—Ç–∞–µ—Ç **–±—ã—Å—Ç—Ä–µ–µ Agent 1**, –Ω–æ –Ω—É–∂–µ–Ω –∑–∞–ø–∞—Å –≤—Ä–µ–º–µ–Ω–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ Agent 1 –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –¥–æ–ª–≥–æ–º –∞–Ω–∞–ª–∏–∑–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚úÖ Agent 2 —É—Å–ø–µ–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª—å—à–æ–π JSON –æ—Ç Agent 1
‚úÖ –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ —Å –±–æ–ª—å—à–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
‚úÖ –ú–µ–Ω—å—à–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∏ –æ—à–∏–±–æ–∫

## –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```
üì§ [Agent 1] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI Responses API...
‚è≥ [Agent 1] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (10—Å)
‚è≥ [Agent 1] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (20—Å)
...
‚úÖ Agent 1 –∑–∞–≤–µ—Ä—à–µ–Ω (318104ms, 30163 —Ç–æ–∫–µ–Ω–æ–≤)

üì§ [Agent 2] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenAI Responses API...
‚è≥ [Agent 2] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (10—Å)
‚è≥ [Agent 2] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞... (20—Å)
...
‚úÖ –ê–ì–ï–ù–¢ 2 –ó–ê–í–ï–†–®–ï–ù: 45000ms, 5000 —Ç–æ–∫–µ–Ω–æ–≤
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

**`lib/services/unifiedAISystem.ts`:**
1. –°—Ç—Ä–æ–∫–∏ 23-24: –†–∞–∑–¥–µ–ª–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –Ω–∞ `AGENT1_TIMEOUT` –∏ `AGENT2_TIMEOUT`
2. –°—Ç—Ä–æ–∫–∏ 288-301: –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è Agent 1
3. –°—Ç—Ä–æ–∫–∏ 489-490: –û–±–Ω–æ–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è Agent 2

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ 3-5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –£–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
3. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å 15+ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è:**
- Agent 1: 3-6 –º–∏–Ω—É—Ç ‚úÖ
- Agent 2: 1-5 –º–∏–Ω—É—Ç ‚úÖ
- –û–±—â–µ–µ –≤—Ä–µ–º—è: 4-11 –º–∏–Ω—É—Ç ‚úÖ

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ï—Å–ª–∏ —Ç–∞–π–º–∞—É—Ç—ã –≤—Å–µ –µ—â–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã, –º–æ–∂–Ω–æ:

1. **–£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –µ—â–µ –±–æ–ª—å—à–µ:**
```typescript
AGENT1_TIMEOUT: 600000, // 10 –º–∏–Ω—É—Ç
AGENT2_TIMEOUT: 480000  // 8 –º–∏–Ω—É—Ç
```

2. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** Agent 1 –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤
4. **–†–∞–∑–±–∏—Ç—å Agent 1** –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥–∑–∞–¥–∞—á
5. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å streaming** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è **–¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏**, –Ω–µ —Å—É–º–º–∞—Ä–Ω–æ
- –ü—Ä–∏ timeout —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç **–¥–æ 3 –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫**
- –ú–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –µ—Å—Ç—å **–∑–∞–¥–µ—Ä–∂–∫–∞** (2—Å, 4—Å, 8—Å)
- –û–±—â–µ–µ –≤—Ä–µ–º—è –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å **30+ –º–∏–Ω—É—Ç** –ø—Ä–∏ –≤—Å–µ—Ö –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
