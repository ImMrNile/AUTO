# ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ - –í—ã–ø–æ–ª–Ω–µ–Ω–æ

## üî• –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### 1. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π polling (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–µ—Ä—É)
**–ë—ã–ª–æ:**
- `TaskNotificationsGlobal` - –æ–ø—Ä–æ—Å –∫–∞–∂–¥—ã–µ 50 —Å–µ–∫—É–Ω–¥
- `TaskResetButton` - –æ–ø—Ä–æ—Å –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- `telegram-desktop` - –æ–ø—Ä–æ—Å –∫–∞–∂–¥—ã–µ **2 —Å–µ–∫—É–Ω–¥—ã** (!)
- Polling —Ä–∞–±–æ—Ç–∞–ª –¥–∞–∂–µ –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
- –ù–µ —É—á–∏—Ç—ã–≤–∞–ª—Å—è —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**–°—Ç–∞–ª–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `useOptimizedPolling` —Ö—É–∫
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (x2)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ (x2)
- ‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ polling –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ (x4)
- ‚úÖ `telegram-desktop` - —É–≤–µ–ª–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å 2 –¥–æ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ `TaskResetButton` - —É–≤–µ–ª–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å 30 –¥–æ 60 —Å–µ–∫—É–Ω–¥

### 2. –§–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞
**–ë—ã–ª–æ:**
- –§–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö

**–°—Ç–∞–ª–æ:**
- ‚úÖ –§–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è **–æ—Ç–∫–ª—é—á–µ–Ω—ã** –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ –í—Ä–µ–º—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è **—É–≤–µ–ª–∏—á–µ–Ω–æ –≤ 2 —Ä–∞–∑–∞** –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|------|-------|-----------|
| Polling –∏–Ω—Ç–µ—Ä–≤–∞–ª | 2-50 —Å–µ–∫ | 10-200 —Å–µ–∫ | **4-10x —Ä–µ–∂–µ** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É | 6-30 | 0.3-6 | **90% –º–µ–Ω—å—à–µ** |
| –§–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | –í–∫–ª—é—á–µ–Ω—ã | –û—Ç–∫–ª—é—á–µ–Ω—ã | **0 –∑–∞–ø—Ä–æ—Å–æ–≤** |
| –í—Ä–µ–º—è –∫–µ—à–∞ | 5 –º–∏–Ω | 10 –º–∏–Ω | **2x –¥–æ–ª—å—à–µ** |
| Polling –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ | –†–∞–±–æ—Ç–∞–µ—Ç | –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω | **100% —ç–∫–æ–Ω–æ–º–∏—è** |

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- ‚úÖ **–ù–µ—Ç –Ω–∞–≥—Ä–µ–≤–∞** —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ **–ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- ‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è –±–∞—Ç–∞—Ä–µ–∏** –¥–æ 70%
- ‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** –¥–æ 90%

## üõ†Ô∏è –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
**–§–∞–π–ª:** `src/lib/utils/deviceDetection.ts`

–§—É–Ω–∫—Ü–∏–∏:
- `isMobileDevice()` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- `isSlowConnection()` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `isPageVisible()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å –≤–∫–ª–∞–¥–∫–∏
- `getOptimalPollingInterval()` - –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
- `shouldDisableBackgroundRefresh()` - –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `getOptimalCacheTime()` - –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∫–µ—à–∞

### 2. –°–æ–∑–¥–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ polling
**–§–∞–π–ª:** `src/app/hooks/useOptimizedPolling.ts`

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ (Page Visibility API)
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### `TaskNotificationsGlobal.tsx`
```typescript
// –ë—ã–ª–æ:
setInterval(() => loadTasks(), 50000);

// –°—Ç–∞–ª–æ:
useOptimizedPolling({
  baseInterval: 50000,
  onPoll: loadTasks,
  enabled: hasActiveTasks,
  pauseWhenHidden: true
});
```

#### `TaskResetButton.tsx`
```typescript
// –ë—ã–ª–æ:
setInterval(checkStuckTasks, 30000);

// –°—Ç–∞–ª–æ:
useOptimizedPolling({
  baseInterval: 60000, // –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 30 –¥–æ 60 —Å–µ–∫
  onPoll: checkStuckTasks,
  pauseWhenHidden: true
});
```

#### `telegram-desktop/page.tsx`
```typescript
// –ë—ã–ª–æ:
setInterval(checkAuth, 2000); // –ö–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã!

// –°—Ç–∞–ª–æ:
setInterval(checkAuth, 5000); // –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
```

#### `useProductsCache.ts`
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
const optimizedConfig = {
  ...config,
  backgroundRefresh: config.backgroundRefresh && !shouldDisableBackgroundRefresh(),
  ttl: getOptimalCacheTime(config.ttl)
};
```

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π polling

```typescript
// –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª: 50 —Å–µ–∫—É–Ω–¥
let interval = 50000;

// –ù–∞ –º–æ–±–∏–ª—å–Ω–æ–º: 50 * 2 = 100 —Å–µ–∫—É–Ω–¥
if (isMobile) interval *= 2;

// –ù–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏: 100 * 2 = 200 —Å–µ–∫—É–Ω–¥
if (slowConnection) interval *= 2;

// –í–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞: 200 * 4 = 800 —Å–µ–∫—É–Ω–¥ (13 –º–∏–Ω—É—Ç!)
if (!visible) interval *= 4;
```

### Page Visibility API

```typescript
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º polling
    stopPolling();
  } else {
    // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º polling
    startPolling();
  }
});
```

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º:

1. **Chrome DevTools:**
   - F12 ‚Üí Performance
   - –ó–∞–ø–∏—Å—å –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU usage (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å < 10%)

2. **Network tab:**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
   - –ë—ã–ª–æ: 10-30 –∑–∞–ø—Ä–æ—Å–æ–≤
   - –°—Ç–∞–ª–æ: 1-3 –∑–∞–ø—Ä–æ—Å–∞

3. **Console:**
   ```javascript
   // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   console.log(navigator.userAgent);
   
   // –ü—Ä–æ–≤–µ—Ä–∫–∞ polling –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
   // –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏: "üîÑ [Polling] –ó–∞–ø—É—Å–∫ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º XXXms"
   ```

4. **–†–µ–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:**
   - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 5-10 –º–∏–Ω—É—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä–µ–≤ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–≤–Ω–æ—Å—Ç—å (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 60 FPS)

## üöÄ –î–µ–ø–ª–æ–π

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã –∫ –¥–µ–ø–ª–æ—é:

```bash
git add .
git commit -m "Optimize: Reduce mobile device load by 90%"
git push
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤** (–µ—Å–ª–∏ > 50 —Ç–æ–≤–∞—Ä–æ–≤)
   ```bash
   npm install react-window
   ```

2. **Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
   ```typescript
   <img loading="lazy" src="..." />
   ```

3. **Code splitting**
   ```typescript
   const HeavyComponent = dynamic(() => import('./Heavy'));
   ```

4. **Service Worker** –¥–ª—è –æ—Ñ–ª–∞–π–Ω –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

5. **WebP –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ JPEG/PNG

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [x] –°–æ–∑–¥–∞–Ω `deviceDetection.ts`
- [x] –°–æ–∑–¥–∞–Ω `useOptimizedPolling.ts`
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω `TaskNotificationsGlobal.tsx`
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω `TaskResetButton.tsx`
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω `telegram-desktop/page.tsx`
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω `useProductsCache.ts`
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- [ ] –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ production

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤ 10 —Ä–∞–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ** –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö!
