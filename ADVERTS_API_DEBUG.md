# üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: /adverts API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 –∫–∞–º–ø–∞–Ω–∏–π

## –ü—Ä–æ–±–ª–µ–º–∞

```
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ ID –∫–∞–º–ø–∞–Ω–∏–π: 27 (–≤—Å–µ–≥–æ: 27)  ‚Üê /count —Ä–∞–±–æ—Ç–∞–µ—Ç
üîé –ù–∞–π–¥–µ–Ω–æ –∫–∞–º–ø–∞–Ω–∏–π –≤—Å–µ–≥–æ: 0              ‚Üê /adverts –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç 27 ID –∫–∞–º–ø–∞–Ω–∏–π, –Ω–æ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—É—á–∞–µ—Ç 0!**

## –ü—Ä–∏—á–∏–Ω—ã

### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

**–¢–µ–∫—É—â–∏–π —Ñ–æ—Ä–º–∞—Ç:**
```json
POST /adv/v1/promotion/adverts
[
  { "id": 27673276 },
  { "id": 27673277 },
  ...
]
```

**–í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–µ–Ω –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç:**
```json
[27673276, 27673277, ...]
```

### 2. API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:
- `400` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
- `403` - –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- `404` - –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- `500` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 3. API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ –º–∞—Å—Å–∏–≤

–í–æ–∑–º–æ–∂–Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç:
```json
{
  "data": [...],
  "total": 27
}
```

–í–º–µ—Å—Ç–æ –º–∞—Å—Å–∏–≤–∞:
```json
[...]
```

## –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ö–ê–ñ–î–û–ì–û –±–∞—Ç—á–∞:

```typescript
// 1. –ü–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
console.log(`üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[27673276, 27673277, ...]`);

// 2. –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
console.log(`üì• –û—Ç–≤–µ—Ç /adverts: status=200`);

// 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
console.log(`üì¶ –ü–æ–ª—É—á–µ–Ω–æ –¥–µ—Ç–∞–ª–µ–π: 0, —Ç–∏–ø=object`);

// 4. –ï—Å–ª–∏ –Ω–µ –º–∞—Å—Å–∏–≤
console.log(`‚ö†Ô∏è –û—Ç–≤–µ—Ç –Ω–µ –º–∞—Å—Å–∏–≤: {"data":[...],"total":27}`);

// 5. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞
console.log(`‚ùå /adverts –æ—à–∏–±–∫–∞ 400: Invalid request format`);
```

## –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (400)

```
üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[27673276, 27673277, ...]
üì• –û—Ç–≤–µ—Ç /adverts: status=400
‚ùå /adverts –æ—à–∏–±–∫–∞ 400: {"error":"Invalid request body","detail":"Expected array of numbers"}
```

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å `[{id:1},{id:2}]` –Ω–∞ `[1,2]`

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (403)

```
üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[27673276, 27673277, ...]
üì• –û—Ç–≤–µ—Ç /adverts: status=403
‚ùå /adverts –æ—à–∏–±–∫–∞ 403: {"error":"Access denied","detail":"Token missing '–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ' scope"}
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö WB

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–≤–µ—Ç –Ω–µ –º–∞—Å—Å–∏–≤ (200)

```
üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[27673276, 27673277, ...]
üì• –û—Ç–≤–µ—Ç /adverts: status=200
üì¶ –ü–æ–ª—É—á–µ–Ω–æ –¥–µ—Ç–∞–ª–µ–π: –Ω–µ –º–∞—Å—Å–∏–≤, —Ç–∏–ø=object
‚ö†Ô∏è –û—Ç–≤–µ—Ç –Ω–µ –º–∞—Å—Å–∏–≤: {"data":[{...},{...}],"total":27}
```

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –Ω–∞ `details.data` –≤–º–µ—Å—Ç–æ `details`

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ (200)

```
üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[27673276, 27673277, ...]
üì• –û—Ç–≤–µ—Ç /adverts: status=200
üì¶ –ü–æ–ª—É—á–µ–Ω–æ –¥–µ—Ç–∞–ª–µ–π: 0, —Ç–∏–ø=object
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫–∞–º–ø–∞–Ω–∏–π: 0
```

**–†–µ—à–µ–Ω–∏–µ:** –ö–∞–º–ø–∞–Ω–∏–∏ —É–¥–∞–ª–µ–Ω—ã –∏–ª–∏ ID –Ω–µ–≤–µ—Ä–Ω—ã–µ

## –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

```typescript
// –í–º–µ—Å—Ç–æ:
body: JSON.stringify(batch.map(id => ({ id })))
// [{"id":1},{"id":2}]

// –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
body: JSON.stringify(batch)
// [1,2,3]
```

### –†–µ—à–µ–Ω–∏–µ 2: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤–º–µ—Å—Ç–æ –º–∞—Å—Å–∏–≤–∞

```typescript
if (detailsResponse.ok) {
  const response = await detailsResponse.json();
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
  let details;
  if (Array.isArray(response)) {
    details = response;
  } else if (response.data && Array.isArray(response.data)) {
    details = response.data;
  } else if (response.adverts && Array.isArray(response.adverts)) {
    details = response.adverts;
  }
  
  if (details && details.length > 0) {
    allCampaigns.push(...details);
  }
}
```

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

–í–º–µ—Å—Ç–æ `/adv/v1/promotion/adverts` –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
- `/adv/v0/adverts` (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
- `/adv/v2/promotion/adverts` (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
http://localhost:3000/test-ai-optimization

### 3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä 356956444

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

**–ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:**
```
üì§ –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π –±–∞—Ç—á–∞ 1: ID=[...]
üì• –û—Ç–≤–µ—Ç /adverts: status=???
üì¶ –ü–æ–ª—É—á–µ–Ω–æ –¥–µ—Ç–∞–ª–µ–π: ???
```

### 5. –ê–Ω–∞–ª–∏–∑ –ø–æ —Å—Ç–∞—Ç—É—Å—É

**status=200:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `üì¶ –ü–æ–ª—É—á–µ–Ω–æ –¥–µ—Ç–∞–ª–µ–π`
- –ï—Å–ª–∏ `–Ω–µ –º–∞—Å—Å–∏–≤` ‚Üí –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ–±—ä–µ–∫—Ç
- –ï—Å–ª–∏ `0` ‚Üí –∫–∞–º–ø–∞–Ω–∏–∏ –ø—É—Å—Ç—ã–µ –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã

**status=400:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
- –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç body

**status=403:**
- –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω "–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ"

**status=404:**
- –ö–∞–º–ø–∞–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- ID –Ω–µ–≤–µ—Ä–Ω—ã–µ –∏–ª–∏ –∫–∞–º–ø–∞–Ω–∏–∏ —É–¥–∞–ª–µ–Ω—ã

**status=500:**
- –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ WB
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ /count

–≠–Ω–¥–ø–æ–∏–Ω—Ç `/count` —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–º–ø–∞–Ω–∏—è—Ö:

```json
{
  "all": 27,
  "adverts": [
    {
      "type": 8,
      "status": 9,
      "count": 5,
      "advert_list": [
        {
          "advertId": 27673276,
          "changeTime": "2024-10-15T10:30:00Z"
        }
      ]
    }
  ]
}
```

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ `/adverts`!

## –†–µ–∑—é–º–µ

### –ü—Ä–æ–±–ª–µ–º–∞
`/adverts` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 –∫–∞–º–ø–∞–Ω–∏–π –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ 27 ID

### –î–æ–±–∞–≤–ª–µ–Ω–æ
–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
- –ó–∞–ø—Ä–æ—Å (ID –∫–∞–º–ø–∞–Ω–∏–π)
- –û—Ç–≤–µ—Ç (—Å—Ç–∞—Ç—É—Å)
- –î–∞–Ω–Ω—ã–µ (—Ç–∏–ø, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- –û—à–∏–±–∫–∏ (—Ç–µ–∫—Å—Ç)

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç?
- –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞?
- –û—Ç–≤–µ—Ç –Ω–µ –º–∞—Å—Å–∏–≤?
- –ö–∞–º–ø–∞–Ω–∏–∏ —É–¥–∞–ª–µ–Ω—ã?

### –í–∞–∂–Ω–æ
**–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å 191 –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–∑ Search Report!**
–ö–∞–º–ø–∞–Ω–∏–∏ - —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.
